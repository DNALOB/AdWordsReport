var AdWordsReport=function(e){e=e||{},e.limit=e.limit,e.remaining=e.remaining,e.exportToSheet=e.exportToSheet,e.zeroImpression=!0,e.awqlOptions={};var t=[],r=function(e){return"--"===e?null:e.split(";").map(Function.prototype.call,String.prototype.trim)},i=function(e){return String(e)},n=function(e){return e=String(e),e.indexOf("%")>-1?parseFloat(e.replace(/[%|<]/g,""))/100:"--"===e?parseFloat(0):parseFloat(e.replace(/,/g,""))},a={AccountCurrencyCode:i,AccountDescriptiveName:i,AccountTimeZoneId:i,ActiveViewCpm:n,ActiveViewImpressions:n,AdFormat:i,AdGroupAdDisapprovalReasons:r,AdGroupCount:n,AdGroupCreativesCount:n,AdGroupCriteriaCount:n,AdGroupCriterionStatus:i,AdGroupId:i,AdGroupName:i,AdGroupsCount:n,AdGroupStatus:i,AdId:i,AdNetworkType1:i,AdNetworkType2:i,AdType:i,AdvertiserExperimentSegmentationBin:i,AdvertiserPhoneNumber:i,AdvertisingChannelSubType:i,AdvertisingChannelType:i,AggregatorId:i,Amount:n,ApprovalStatus:i,AssociatedCampaignId:i,AssociatedCampaignName:i,AssociatedCampaignStatus:i,AttributeValues:r,AverageCpc:n,AverageCpm:n,AverageFrequency:n,AveragePageviews:n,AveragePosition:n,AverageTimeOnSite:n,AvgCostForOfflineInteraction:n,BenchmarkAverageMaxCpc:n,BenchmarkCtr:n,BiddingStrategyId:i,BiddingStrategyName:i,BiddingStrategyType:i,BidModifier:n,BidType:i,BounceRate:n,Brand:i,BudgetCampaignAssociationStatus:i,BudgetId:i,BudgetName:i,BudgetReferenceCount:n,BudgetStatus:i,CallDuration:n,CallEndTime:n,CallerCountryCallingCode:i,CallerNationalDesignatedCode:i,CallStartTime:n,CallStatus:i,CallType:i,CampaignCount:n,CampaignId:i,CampaignName:i,CampaignsCount:n,CampaignStatus:i,CanManageClients:i,Category0:i,Category1:i,Category2:i,CategoryL1:i,CategoryL2:i,CategoryL3:i,CategoryL4:i,CategoryL5:i,CategoryPaths:i,Channel:i,ChannelExclusivity:i,CityCriteriaId:i,ClickAssistedConversions:n,ClickAssistedConversionsOverLastClickConversions:n,ClickAssistedConversionValue:n,ClickConversionRate:n,ClickConversionRateSignificance:n,Clicks:n,ClickSignificance:n,ClickType:i,CombinedAdsOrganicClicks:n,CombinedAdsOrganicClicksPerQuery:n,CombinedAdsOrganicQueries:n,ContentBidCriterionTypeGroup:i,ContentBudgetLostImpressionShare:n,ContentImpressionShare:n,ContentRankLostImpressionShare:n,ConversionCategoryName:i,ConversionManyPerClickSignificance:n,ConversionRateManyPerClick:n,ConversionRateManyPerClickSignificance:n,ConversionsManyPerClick:n,ConversionTrackerId:i,ConversionTypeName:i,ConversionValue:n,ConvertedClicks:n,ConvertedClicksSignificance:n,Cost:n,CostPerConversionManyPerClick:n,CostPerConversionManyPerClickSignificance:n,CostPerConvertedClick:n,CostPerConvertedClickSignificance:n,CostPerEstimatedTotalConversion:n,CostSignificance:n,CountryCriteriaId:i,CpcBid:i,CpcBidSource:i,CpcSignificance:n,CpmBid:n,CpmBidSource:i,CpmSignificance:n,CreativeApprovalStatus:i,CreativeDestinationUrl:i,CreativeFinalAppUrls:r,CreativeFinalMobileUrls:r,CreativeFinalUrls:r,CreativeId:i,CreativeTrackingUrlTemplate:i,CreativeUrlCustomParameters:i,Criteria:i,CriteriaDestinationUrl:i,CriteriaId:i,CriteriaParameters:i,CriteriaStatus:i,CriteriaType:i,CriteriaTypeName:i,CriterionId:i,Ctr:n,CtrSignificance:n,CustomAttribute0:i,CustomAttribute1:i,CustomAttribute2:i,CustomAttribute3:i,CustomAttribute4:i,CustomerDescriptiveName:i,Date:i,DayOfWeek:i,DeliveryMethod:i,Description1:i,Description2:i,DestinationUrl:i,Device:i,DevicePreference:i,DisapprovalShortNames:r,DisplayName:i,DisplayUrl:i,DistanceBucket:i,Domain:i,EffectiveDestinationUrl:i,EndTime:i,EnhancedCpcEnabled:i,EstimatedCrossDeviceConversions:n,EstimatedTotalConversionRate:n,EstimatedTotalConversions:n,EstimatedTotalConversionValue:n,EstimatedTotalConversionValuePerClick:n,EstimatedTotalConversionValuePerCost:n,ExtensionPlaceholderCreativeId:i,ExtensionPlaceholderType:i,ExternalCustomerId:i,FeedId:i,FeedItemAttributes:r,FeedItemEndTime:i,FeedItemId:i,FeedItemStartTime:i,FeedItemStatus:i,FinalAppUrls:r,FinalMobileUrls:r,FinalUrls:r,FirstPageCpc:n,GclId:i,Headline:i,HourOfDay:n,Id:i,ImageAdUrl:i,ImageCreativeName:i,ImpressionAssistedConversions:n,ImpressionAssistedConversionsOverLastClickConversions:n,ImpressionAssistedConversionValue:n,ImpressionReach:n,Impressions:n,ImpressionSignificance:n,InvalidClickRate:n,InvalidClicks:n,IsAutoOptimized:i,IsAutoTaggingEnabled:i,IsBidOnPath:i,IsBudgetExplicitlyShared:i,IsNegative:i,IsPathExcluded:i,IsRestrict:i,IsSelfAction:i,IsTargetingLocation:i,IsTestAccount:i,KeywordId:i,KeywordMatchType:i,KeywordText:i,KeywordTextMatchingQuery:i,LabelId:i,LabelIds:r,LabelName:i,Labels:r,LanguageCriteriaId:i,Line1:i,LocationType:i,MatchType:i,MatchTypeWithVariant:i,MemberCount:n,MerchantId:i,MetroCriteriaId:i,Month:i,MonthOfYear:i,MostSpecificCriteriaId:i,Name:i,NonRemovedAdGroupCount:n,NonRemovedAdGroupCriteriaCount:n,NonRemovedCampaignCount:n,NumOfflineImpressions:n,NumOfflineInteractions:n,OfferId:i,OfflineInteractionCost:n,OfflineInteractionRate:n,OrganicAveragePosition:n,OrganicClicks:n,OrganicClicksPerQuery:n,OrganicImpressions:n,OrganicImpressionsPerQuery:n,OrganicQueries:n,Page:n,PageOnePromotedBidCeiling:n,PageOnePromotedBidChangesForRaisesOnly:i,PageOnePromotedBidModifier:n,PageOnePromotedRaiseBidWhenBudgetConstrained:i,PageOnePromotedRaiseBidWhenLowQualityScore:i,PageOnePromotedStrategyGoal:i,Parameter:i,ParentCriterionId:i,PartitionType:i,PercentNewVisitors:n,Period:i,PlaceholderType:n,PlacementUrl:i,PositionSignificance:n,PrimaryCompanyName:i,ProductCondition:i,ProductGroup:i,ProductTypeL1:i,ProductTypeL2:i,ProductTypeL3:i,ProductTypeL4:i,ProductTypeL5:i,QualityScore:n,Quarter:i,Query:i,ReferenceCount:n,RegionCriteriaId:i,RelativeCtr:n,Scheduling:i,SearchBudgetLostImpressionShare:n,SearchExactMatchImpressionShare:n,SearchImpressionShare:n,SearchQuery:i,SearchRankLostImpressionShare:n,SerpType:i,ServingStatus:i,SharedSetId:i,SharedSetName:i,SharedSetType:i,Slot:i,StartTime:i,Status:i,StoreId:i,TargetCpa:n,TargetCpaMaxCpcBidCeiling:n,TargetCpaMaxCpcBidFloor:n,TargetOutrankShare:n,TargetOutrankShareBidChangesForRaisesOnly:i,TargetOutrankShareCompetitorDomain:i,TargetOutrankShareMaxCpcBidCeiling:n,TargetOutrankShareRaiseBidWhenLowQualityScore:i,TargetRoas:n,TargetRoasBidCeiling:n,TargetRoasBidFloor:n,TargetSpendBidCeiling:n,TargetSpendSpendTarget:n,Title:i,TopOfPageCpc:n,TotalBudget:n,TotalCost:n,TrackingUrlTemplate:i,Trademarks:r,Type:i,Url:i,UrlCustomParameters:i,UserListId:i,UserListsCount:n,ValidationDetails:r,ValuePerConversionManyPerClick:n,ValuePerConvertedClick:n,ValuePerEstimatedTotalConversion:n,ViewThroughConversions:n,ViewThroughConversionsSignificance:n,Week:i,Year:i},o=function(t){return Array.isArray(t)&&(t=t.join(",")),e.awqlOptions.select=t,{from:s}},s=function(t){return e.awqlOptions.from=t,{where:d,and:C,during:l}},d=function(t){return e.awqlOptions.where=t,{and:C,during:l}},C=function(t){return e.awqlOptions.and||(e.awqlOptions.and=[]),Array.isArray(t)?e.awqlOptions.and=[].contact.apply([],e.awqlOptions.and,t):e.awqlOptions.and.push(t),{and:C,during:l}},l=function(t){return Array.isArray(t)&&(t=t.join(",")),e.awqlOptions.during=t,{run:c}},c=function(){var t=e.awqlOptions;"object"==typeof e.awqlOptions?(t="SELECT "+e.awqlOptions.select+" FROM "+e.awqlOptions.from,e.awqlOptions.where&&(t+=" WHERE "+e.awqlOptions.where),e.awqlOptions.and&&(t+=" AND "+e.awqlOptions.and.join(" AND ")),e.awqlOptions.during&&(t+=" DURING "+e.awqlOptions.during)):"string"==typeof t&&(t=t.split(", ").join(",")),options={includeZeroImpressions:e.zeroImpression},e.awqlOptions={};var r=AdWordsApp.report(t,options);return m(r)},p=function(){return t.length>0},u=function(){return t.splice(t.length-1,1)[0]},g=function(){if(t.length>0)return{hasNext:p,next:u};throw new Error("There is no rows...")},m=function(r){var i={};i.rows=g,i.data=[];var n=(new Date).toLocaleDateString();if(e.exportToSheet){var o=SpreadsheetApp.create("AdWordsReport - "+n);r.exportToSheet(o.getActiveSheet()),i.sheetUrl=o.getUrl(),i.sheetId=o.getId(),i.sheetName=o.getName()}for(var s=r.rows();s.hasNext();){var d=s.next(),C={},l=Object.keys(d);l.forEach(function(e){if(void 0!=a[e]){var t=d[e];C[e]=a[e](t)}}),i.data.push(C)}return t=i.data,i};return this.use=function(t){if("object"!=typeof t)throw new Error('Wrong params "options"');"boolean"==typeof t.exportToSheet&&(e.exportToSheet=t.exportToSheet),"boolean"==typeof t.zeroImpression&&(e.zeroImpression=t.zeroImpression)},this.awql=function(t){return t?(e.awqlOptions=t,Array.isArray(e.awqlOptions.select)&&(e.awqlOptions.select=e.awqlOptions.select.join(",")),Array.isArray(e.awqlOptions.during)&&(e.awqlOptions.during=e.awqlOptions.during.joing(",")),{run:c}):{select:o}},this};