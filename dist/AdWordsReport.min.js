var AdWordsReport=function(e){"use strict";e=e||{},e.exportToSheet=e.exportToSheet||!1,e.zeroImpression=e.zeroImpression||!0,e.lowImpressionShare=e.lowImpressionShare||.01,e.awqlOptions={};var r=[],t=function(e){return"--"===e?[]:e.split(";").map(Function.prototype.call,String.prototype.trim)},i=function(e){return String(e)},a=function(r){return r=String(r),r.indexOf("<")>-1?e.lowImpressionShare:r.indexOf("%")>-1?Number(r.replace(/[%]/g,""))/100:"--"===r?Number(0):Number(r.replace(/,/g,""))},n={AccountCurrencyCode:i,AccountDescriptiveName:i,AccountTimeZoneId:i,ActiveViewCpm:a,ActiveViewImpressions:a,AdFormat:i,AdGroupAdDisapprovalReasons:t,AdGroupCount:a,AdGroupCreativesCount:a,AdGroupCriteriaCount:a,AdGroupCriterionStatus:i,AdGroupId:i,AdGroupName:i,AdGroupsCount:a,AdGroupStatus:i,AdId:i,AdNetworkType1:i,AdNetworkType2:i,AdType:i,AdvertiserExperimentSegmentationBin:i,AdvertiserPhoneNumber:i,AdvertisingChannelSubType:i,AdvertisingChannelType:i,AggregatorId:i,Amount:a,ApprovalStatus:i,AssociatedCampaignId:i,AssociatedCampaignName:i,AssociatedCampaignStatus:i,AttributeValues:t,AverageCpc:a,AverageCpm:a,AverageFrequency:a,AveragePageviews:a,AveragePosition:a,AverageTimeOnSite:a,AvgCostForOfflineInteraction:a,BenchmarkAverageMaxCpc:a,BenchmarkCtr:a,BiddingStrategyId:i,BiddingStrategyName:i,BiddingStrategyType:i,BidModifier:a,BidType:i,BounceRate:a,Brand:i,BudgetCampaignAssociationStatus:i,BudgetId:i,BudgetName:i,BudgetReferenceCount:a,BudgetStatus:i,CallDuration:a,CallEndTime:a,CallerCountryCallingCode:i,CallerNationalDesignatedCode:i,CallStartTime:a,CallStatus:i,CallType:i,CampaignCount:a,CampaignId:i,CampaignName:i,CampaignsCount:a,CampaignStatus:i,CanManageClients:i,Category0:i,Category1:i,Category2:i,CategoryL1:i,CategoryL2:i,CategoryL3:i,CategoryL4:i,CategoryL5:i,CategoryPaths:i,Channel:i,ChannelExclusivity:i,CityCriteriaId:i,ClickAssistedConversions:a,ClickAssistedConversionsOverLastClickConversions:a,ClickAssistedConversionValue:a,ClickConversionRate:a,ClickConversionRateSignificance:a,Clicks:a,ClickSignificance:a,ClickType:i,CombinedAdsOrganicClicks:a,CombinedAdsOrganicClicksPerQuery:a,CombinedAdsOrganicQueries:a,ContentBidCriterionTypeGroup:i,ContentBudgetLostImpressionShare:a,ContentImpressionShare:a,ContentRankLostImpressionShare:a,ConversionCategoryName:i,ConversionManyPerClickSignificance:a,ConversionRateManyPerClick:a,ConversionRateManyPerClickSignificance:a,ConversionsManyPerClick:a,ConversionTrackerId:i,ConversionTypeName:i,ConversionValue:a,ConvertedClicks:a,ConvertedClicksSignificance:a,Cost:a,CostPerConversionManyPerClick:a,CostPerConversionManyPerClickSignificance:a,CostPerConvertedClick:a,CostPerConvertedClickSignificance:a,CostPerEstimatedTotalConversion:a,CostSignificance:a,CountryCriteriaId:i,CpcBid:i,CpcBidSource:i,CpcSignificance:a,CpmBid:a,CpmBidSource:i,CpmSignificance:a,CreativeApprovalStatus:i,CreativeDestinationUrl:i,CreativeFinalAppUrls:t,CreativeFinalMobileUrls:t,CreativeFinalUrls:t,CreativeId:i,CreativeTrackingUrlTemplate:i,CreativeUrlCustomParameters:i,CreativeQualityScore:i,Criteria:i,CriteriaDestinationUrl:i,CriteriaId:i,CriteriaParameters:i,CriteriaStatus:i,CriteriaType:i,CriteriaTypeName:i,CriterionId:i,Ctr:a,CtrSignificance:a,CustomAttribute0:i,CustomAttribute1:i,CustomAttribute2:i,CustomAttribute3:i,CustomAttribute4:i,CustomerDescriptiveName:i,Date:i,DayOfWeek:i,DeliveryMethod:i,Description1:i,Description2:i,DestinationUrl:i,Device:i,DevicePreference:i,DisapprovalShortNames:t,DisplayName:i,DisplayUrl:i,DistanceBucket:i,Domain:i,EffectiveDestinationUrl:i,EndTime:i,EnhancedCpcEnabled:i,EstimatedAddClicksAtFirstPositionCpc:a,EstimatedAddCostAtFirstPositionCpc:a,EstimatedCrossDeviceConversions:a,EstimatedTotalConversionRate:a,EstimatedTotalConversions:a,EstimatedTotalConversionValue:a,EstimatedTotalConversionValuePerClick:a,EstimatedTotalConversionValuePerCost:a,ExtensionPlaceholderCreativeId:i,ExtensionPlaceholderType:i,ExternalCustomerId:i,FeedId:i,FeedItemAttributes:t,FeedItemEndTime:i,FeedItemId:i,FeedItemStartTime:i,FeedItemStatus:i,FinalAppUrls:t,FinalMobileUrls:t,FinalUrls:t,FirstPageCpc:a,FirstPositionCpc:a,GclId:i,Headline:i,HourOfDay:a,Id:i,ImageAdUrl:i,ImageCreativeName:i,ImpressionAssistedConversions:a,ImpressionAssistedConversionsOverLastClickConversions:a,ImpressionAssistedConversionValue:a,ImpressionReach:a,Impressions:a,ImpressionSignificance:a,InvalidClickRate:a,InvalidClicks:a,IsAutoOptimized:i,IsAutoTaggingEnabled:i,IsBidOnPath:i,IsBudgetExplicitlyShared:i,IsNegative:i,IsPathExcluded:i,IsRestrict:i,IsSelfAction:i,IsTargetingLocation:i,IsTestAccount:i,KeywordId:i,KeywordMatchType:i,KeywordText:i,KeywordTextMatchingQuery:i,LabelId:i,LabelIds:t,LabelName:i,Labels:t,LanguageCriteriaId:i,Line1:i,LocationType:i,MatchType:i,MatchTypeWithVariant:i,MemberCount:a,MerchantId:i,MetroCriteriaId:i,Month:i,MonthOfYear:i,MostSpecificCriteriaId:i,Name:i,NonRemovedAdGroupCount:a,NonRemovedAdGroupCriteriaCount:a,NonRemovedCampaignCount:a,NumOfflineImpressions:a,NumOfflineInteractions:a,OfferId:i,OfflineInteractionCost:a,OfflineInteractionRate:a,OrganicAveragePosition:a,OrganicClicks:a,OrganicClicksPerQuery:a,OrganicImpressions:a,OrganicImpressionsPerQuery:a,OrganicQueries:a,Page:a,PageOnePromotedBidCeiling:a,PageOnePromotedBidChangesForRaisesOnly:i,PageOnePromotedBidModifier:a,PageOnePromotedRaiseBidWhenBudgetConstrained:i,PageOnePromotedRaiseBidWhenLowQualityScore:i,PageOnePromotedStrategyGoal:i,Parameter:i,ParentCriterionId:i,PartitionType:i,PercentNewVisitors:a,Period:i,PlaceholderType:a,PlacementUrl:i,PostClickQualityScore:i,PositionSignificance:a,PrimaryCompanyName:i,ProductCondition:i,ProductGroup:i,ProductTypeL1:i,ProductTypeL2:i,ProductTypeL3:i,ProductTypeL4:i,ProductTypeL5:i,QualityScore:a,Quarter:i,Query:i,ReferenceCount:a,RegionCriteriaId:i,RelativeCtr:a,Scheduling:i,SearchBudgetLostImpressionShare:a,SearchExactMatchImpressionShare:a,SearchImpressionShare:a,SearchPredictedCtr:i,SearchQuery:i,SearchRankLostImpressionShare:a,SerpType:i,ServingStatus:i,SharedSetId:i,SharedSetName:i,SharedSetType:i,Slot:i,StartTime:i,Status:i,StoreId:i,TargetCpa:a,TargetCpaMaxCpcBidCeiling:a,TargetCpaMaxCpcBidFloor:a,TargetOutrankShare:a,TargetOutrankShareBidChangesForRaisesOnly:i,TargetOutrankShareCompetitorDomain:i,TargetOutrankShareMaxCpcBidCeiling:a,TargetOutrankShareRaiseBidWhenLowQualityScore:i,TargetRoas:a,TargetRoasBidCeiling:a,TargetRoasBidFloor:a,TargetSpendBidCeiling:a,TargetSpendSpendTarget:a,Title:i,TopOfPageCpc:a,TotalBudget:a,TotalCost:a,TrackingUrlTemplate:i,Trademarks:t,Type:i,Url:i,UrlCustomParameters:i,UserListId:i,UserListsCount:a,ValidationDetails:t,ValuePerConversionManyPerClick:a,ValuePerConvertedClick:a,ValuePerEstimatedTotalConversion:a,ViewThroughConversions:a,ViewThroughConversionsSignificance:a,Week:i,Year:i},o=function(e,r){var t={};return r.forEach(function(r){if(void 0!==n[r]){var i=e[r];t[r]=n[r](i)}}),t},s=function(r){return Array.isArray(r)&&(r=r.join(",")),e.awqlOptions.select=r,{from:d}},d=function(r){return e.awqlOptions.from=r,{where:C,and:l,during:c}},C=function(r){return e.awqlOptions.where=r,{and:l,during:c}},l=function(r){return e.awqlOptions.and||(e.awqlOptions.and=[]),Array.isArray(r)?e.awqlOptions.and=[].contact.apply([],e.awqlOptions.and,r):e.awqlOptions.and.push(r),{and:l,during:c}},c=function(r){return Array.isArray(r)&&(r=r.join(",")),e.awqlOptions.during=r,{run:p}},p=function(){var r=e.awqlOptions;"object"==typeof e.awqlOptions?(r="SELECT "+e.awqlOptions.select+" FROM "+e.awqlOptions.from,e.awqlOptions.where&&(r+=" WHERE "+e.awqlOptions.where),e.awqlOptions.and&&(r+=" AND "+e.awqlOptions.and.join(" AND ")),e.awqlOptions.during&&(r+=" DURING "+e.awqlOptions.during)):"string"==typeof r&&(r=r.split(", ").join(","));var t={includeZeroImpressions:e.zeroImpression};e.awqlOptions={};var i=AdWordsApp.report(r,t);return S(i)},u=function(){return this.data.length>0},g=function(){return this.data.splice(this.data.length-1,1)[0]},m=function(){return r.length>0?{hasNext:u,next:g,data:JSON.parse(JSON.stringify(r))}:void Logger.log("Cant use .rows() since there are no rows.")},S=function(t){var i={};i.rows=m,i.data=[];var a=(new Date).toLocaleDateString();if(e.exportToSheet){var n=SpreadsheetApp.create("AdWordsReport - "+a);t.exportToSheet(n.getActiveSheet()),i.sheetUrl=n.getUrl(),i.sheetId=n.getId(),i.sheetName=n.getName()}for(var s=t.rows();s.hasNext();){var d=s.next(),C=Object.keys(d),l=o(d,C);i.data.push(l)}return r=JSON.parse(JSON.stringify(i.data)),i};return this.use=function(r){if("object"!=typeof r)throw new Error("Wrong params in .use()");"boolean"==typeof r.exportToSheet&&(e.exportToSheet=r.exportToSheet),"boolean"==typeof r.zeroImpression&&(e.zeroImpression=r.zeroImpression),"number"==typeof r.lowImpressionShare&&(e.lowImpressionShare=r.lowImpressionShare)},this.awql=function(r){return r?(e.awqlOptions=r,Array.isArray(e.awqlOptions.select)&&(e.awqlOptions.select=e.awqlOptions.select.join(",")),Array.isArray(e.awqlOptions.during)&&(e.awqlOptions.during=e.awqlOptions.during.join(",")),{run:p}):{select:s}},this};