/**
 * @license MIT
 * @author Victor Kaugesaar <kaugesaar@gmail.com>
 * AdWordsReport.js (http://github.com/getscript/AdWordsReport)
 * Built for AdWords API v201607
 * Licensed under the MIT license
 */
var AdWordsReport=function(e){"use strict";e=e||{},e.exportToSheet=e.exportToSheet||!1,e.zeroImpression=e.zeroImpression||!0,e.lowImpressionShare=e.lowImpressionShare||.01,e.awqlOptions={};var i=[],r=function(e){return n(e)},t=function(e){return _stirng(e)},a=function(e){return"--"===e?[]:"object"==typeof JSON.parse(e)?JSON.parse(e):[e]},n=function(e){return String(e)},o=function(i){return i=String(i),i.indexOf("<")>-1?e.lowImpressionShare:i.indexOf("%")>-1?Number(i.replace(/[%]/g,""))/100:"--"===i?Number(0):Number(i.replace(/,/g,""))},s={AccountCurrencyCode:n,AccountDescriptiveName:n,AccountTimeZoneId:n,ActiveViewCpm:o,ActiveViewCtr:o,ActiveViewImpressions:o,ActiveViewMeasurability:o,ActiveViewMeasurableCost:o,ActiveViewMeasurableImpressions:o,ActiveViewViewability:o,AdFormat:n,AdGroupAdDisapprovalReasons:a,AdGroupAdTrademarkDisapproved:t,AdGroupCount:o,AdGroupCreativesCount:o,AdGroupCriteriaCount:o,AdGroupCriterionStatus:n,AdGroupDesktopBidModifier:o,AdGroupId:o,AdGroupMobileBidModifier:o,AdGroupName:n,AdGroupsCount:o,AdGroupStatus:n,AdGroupTabletBidModifier:o,AdId:o,AdNetworkType1:n,AdNetworkType2:n,AdType:n,AdvertiserExperimentSegmentationBin:n,AdvertisingChannelSubType:n,AdvertisingChannelType:n,AggregatorId:o,AllConversionRate:o,AllConversions:o,AllConversionValue:o,Amount:o,AoiMostSpecificTargetId:o,ApprovalStatus:n,AssociatedCampaignId:o,AssociatedCampaignName:n,AssociatedCampaignStatus:n,AttributeValues:a,AverageCost:o,AverageCpc:o,AverageCpe:o,AverageCpm:o,AverageCpv:o,AverageFrequency:o,AveragePageviews:o,AveragePosition:o,AverageTimeOnSite:o,BaseAdGroupId:o,BaseCampaignId:o,BenchmarkAverageMaxCpc:o,BenchmarkCtr:o,BiddingStrategyId:o,BiddingStrategyName:n,BiddingStrategySource:n,BiddingStrategyType:n,BidModifier:o,BidType:n,BounceRate:o,Brand:n,BudgetCampaignAssociationStatus:n,BudgetId:o,BudgetName:n,BudgetReferenceCount:o,BudgetStatus:n,BusinessName:n,CallDuration:o,CallEndTime:o,CallerCountryCallingCode:n,CallerNationalDesignatedCode:n,CallOnlyPhoneNumber:n,CallStartTime:o,CallStatus:n,CallTrackingDisplayLocation:n,CallType:n,CampaignCount:o,CampaignDesktopBidModifier:o,CampaignId:o,CampaignLocationTargetId:o,CampaignMobileBidModifier:o,CampaignName:n,CampaignsCount:o,CampaignStatus:n,CampaignTabletBidModifier:o,CampaignTrialType:n,CanManageClients:t,Category0:n,Category1:n,Category2:n,CategoryL1:n,CategoryL2:n,CategoryL3:n,CategoryL4:n,CategoryL5:n,CategoryPaths:n,Channel:n,ChannelExclusivity:n,CityCriteriaId:o,ClickAssistedConversions:o,ClickAssistedConversionsOverLastClickConversions:o,ClickAssistedConversionValue:o,Clicks:o,ClickSignificance:o,ClickType:n,CombinedAdsOrganicClicks:o,CombinedAdsOrganicClicksPerQuery:o,CombinedAdsOrganicQueries:o,ContentBidCriterionTypeGroup:n,ContentBudgetLostImpressionShare:o,ContentImpressionShare:o,ContentRankLostImpressionShare:o,ConversionCategoryName:n,ConversionRate:o,Conversions:o,ConversionTrackerId:o,ConversionTypeName:n,ConversionValue:o,Cost:o,CostPerAllConversion:o,CostPerConversion:o,CostSignificance:o,CountryCriteriaId:o,CpcBid:o,CpcBidSource:n,CpcSignificance:o,CpmBid:o,CpmBidSource:n,CpmSignificance:o,CpvBid:o,CpvBidSource:n,CreativeApprovalStatus:n,CreativeConversionRate:o,CreativeConversions:o,CreativeDestinationUrl:n,CreativeFinalAppUrls:a,CreativeFinalMobileUrls:a,CreativeFinalUrls:a,CreativeId:o,CreativeQualityScore:n,CreativeStatus:n,CreativeTrackingUrlTemplate:n,CreativeUrlCustomParameters:a,Criteria:n,CriteriaDestinationUrl:n,CriteriaId:o,CriteriaParameters:n,CriteriaStatus:n,CriteriaType:n,CriteriaTypeName:n,CriterionId:o,CriterionType:n,CrossDeviceConversions:o,Ctr:o,CtrSignificance:o,CustomAttribute0:n,CustomAttribute1:n,CustomAttribute2:n,CustomAttribute3:n,CustomAttribute4:n,CustomerDescriptiveName:n,Date:r,DayOfWeek:n,DeliveryMethod:n,Description:n,Description1:n,Description2:n,DestinationUrl:n,Device:n,DevicePreference:o,DisapprovalShortNames:a,DisplayName:n,DisplayUrl:n,DistanceBucket:n,Domain:n,EffectiveDestinationUrl:n,EffectiveFinalUrl:n,EffectiveTrackingUrlTemplate:n,EndDate:r,EndTime:r,EngagementRate:o,Engagements:o,EnhancedCpcEnabled:t,EnhancedCpvEnabled:t,EstimatedAddClicksAtFirstPositionCpc:o,EstimatedAddCostAtFirstPositionCpc:o,ExtensionPlaceholderCreativeId:o,ExtensionPlaceholderType:o,ExternalCustomerId:o,FeedId:o,FeedItemAttributes:a,FeedItemEndTime:o,FeedItemId:o,FeedItemStartTime:o,FeedItemStatus:n,FinalAppUrls:a,FinalMobileUrls:a,FinalUrl:n,FinalUrls:a,FirstPageCpc:o,FirstPositionCpc:o,GclId:n,GeoTargetingCriterionId:o,GeoTargetingRestriction:n,GmailForwards:o,GmailSaves:o,GmailSecondaryClicks:o,HasQualityScore:t,Headline:n,HeadlinePart1:n,HeadlinePart2:n,HourOfDay:o,Id:o,ImageAdUrl:n,ImageCreativeImageHeight:o,ImageCreativeImageWidth:o,ImageCreativeName:n,ImpressionAssistedConversions:o,ImpressionAssistedConversionsOverLastClickConversions:o,ImpressionAssistedConversionValue:o,ImpressionReach:o,Impressions:o,ImpressionSignificance:o,InteractionRate:o,Interactions:o,InteractionTypes:n,InvalidClickRate:o,InvalidClicks:o,IsAutoOptimized:t,IsAutoTaggingEnabled:t,IsBidOnPath:t,IsBudgetExplicitlyShared:t,IsNegative:t,IsPathExcluded:t,IsRestrict:t,IsSelfAction:t,IsTargetingLocation:t,IsTestAccount:t,KeywordId:o,KeywordMatchType:n,KeywordTargetingId:o,KeywordTargetingMatchType:n,KeywordTargetingText:n,KeywordTextMatchingQuery:n,LabelId:o,LabelIds:a,LabelName:n,Labels:a,LanguageCriteriaId:o,Line1:n,LocationType:n,LongHeadline:n,LopMostSpecificTargetId:o,MemberCount:o,MerchantId:o,MetroCriteriaId:o,Month:n,MonthOfYear:n,MostSpecificCriteriaId:o,Name:n,NonRemovedAdGroupCount:o,NonRemovedAdGroupCriteriaCount:o,NonRemovedCampaignCount:o,NumOfflineImpressions:o,NumOfflineInteractions:o,OfferId:n,OfflineInteractionRate:o,OrganicAveragePosition:o,OrganicClicks:o,OrganicClicksPerQuery:o,OrganicImpressions:o,OrganicImpressionsPerQuery:o,OrganicQueries:o,Page:o,PageOnePromotedBidCeiling:o,PageOnePromotedBidChangesForRaisesOnly:t,PageOnePromotedBidModifier:o,PageOnePromotedRaiseBidWhenBudgetConstrained:t,PageOnePromotedRaiseBidWhenLowQualityScore:t,PageOnePromotedStrategyGoal:n,Parameter:n,ParentCriterionId:o,PartitionType:n,Path1:n,Path2:n,PercentNewVisitors:o,Period:n,PlaceholderType:o,PositionSignificance:o,PostClickQualityScore:n,PrimaryCompanyName:n,ProductCondition:n,ProductGroup:n,ProductTypeL1:n,ProductTypeL2:n,ProductTypeL3:n,ProductTypeL4:n,ProductTypeL5:n,QualityScore:o,Quarter:n,Query:n,QueryMatchType:n,QueryMatchTypeWithVariant:n,ReferenceCount:o,RegionCriteriaId:o,RelativeCtr:o,Scheduling:a,SearchBudgetLostImpressionShare:o,SearchClickShare:o,SearchExactMatchImpressionShare:o,SearchImpressionShare:o,SearchPredictedCtr:n,SearchQuery:n,SearchRankLostImpressionShare:o,SerpType:n,ServingStatus:n,SharedSetId:o,SharedSetName:n,SharedSetType:n,ShortHeadline:n,Slot:n,StartDate:r,StartTime:r,Status:n,StoreId:n,SystemServingStatus:n,SystemStatus:n,TargetCpa:o,TargetCpaBidSource:n,TargetCpaMaxCpcBidCeiling:o,TargetCpaMaxCpcBidFloor:o,TargetingAdGroupId:o,TargetingCampaignId:o,TargetOutrankShare:o,TargetOutrankShareBidChangesForRaisesOnly:t,TargetOutrankShareCompetitorDomain:n,TargetOutrankShareMaxCpcBidCeiling:o,TargetOutrankShareRaiseBidWhenLowQualityScore:t,TargetRoas:o,TargetRoasBidCeiling:o,TargetRoasBidFloor:o,TargetSpendBidCeiling:o,TargetSpendSpendTarget:o,Title:n,TopOfPageCpc:o,TrackingUrlTemplate:n,Trademarks:a,Type:n,Url:n,UrlCustomParameters:a,UserListId:o,UserListName:n,UserListsCount:o,ValidationDetails:a,ValuePerAllConversion:o,ValuePerConversion:o,VideoChannelId:n,VideoDuration:o,VideoId:n,VideoQuartile100Rate:o,VideoQuartile25Rate:o,VideoQuartile50Rate:o,VideoQuartile75Rate:o,VideoTitle:n,VideoViewRate:o,VideoViews:o,ViewThroughConversions:o,ViewThroughConversionsSignificance:o,Week:n,Year:o},d=function(e,i){var r={};return i.forEach(function(i){if(void 0!==s[i]){var t=e[i];r[i]=s[i](t)}}),r},p=function(i){return Array.isArray(i)&&(i=i.join(",")),e.awqlOptions.select=i,{from:l}},l=function(i){return e.awqlOptions.from=i,{where:C,and:c,during:u}},C=function(i){return e.awqlOptions.where=i,{and:c,during:u}},c=function(i){return e.awqlOptions.and||(e.awqlOptions.and=[]),Array.isArray(i)?e.awqlOptions.and=[].contact.apply([],e.awqlOptions.and,i):e.awqlOptions.and.push(i),{and:c,during:u}},u=function(i){return Array.isArray(i)&&(i=i.join(",")),e.awqlOptions.during=i,{run:g}},g=function(){var i=e.awqlOptions;"object"==typeof e.awqlOptions?(i="SELECT "+e.awqlOptions.select+" FROM "+e.awqlOptions.from,e.awqlOptions.where&&(i+=" WHERE "+e.awqlOptions.where),e.awqlOptions.and&&(i+=" AND "+e.awqlOptions.and.join(" AND ")),e.awqlOptions.during&&(i+=" DURING "+e.awqlOptions.during)):"string"==typeof i&&(i=i.split(", ").join(","));var r={includeZeroImpressions:e.zeroImpression};e.awqlOptions={};var t=AdWordsApp.report(i,r);return y(t)},m=function(){return this.data.length>0},S=function(){return this.data.splice(this.data.length-1,1)[0]},v=function(){return i.length>0?{hasNext:m,next:S,data:JSON.parse(JSON.stringify(i))}:void Logger.log("Cant use .rows() since there are no rows.")},y=function(r){var t={};t.rows=v,t.data=[];var a=(new Date).toLocaleDateString();if(e.exportToSheet){var n=SpreadsheetApp.create("AdWordsReport - "+a);r.exportToSheet(n.getActiveSheet()),t.sheetUrl=n.getUrl(),t.sheetId=n.getId(),t.sheetName=n.getName()}for(var o=r.rows();o.hasNext();){var s=o.next(),p=Object.keys(s),l=d(s,p);t.data.push(l)}return i=JSON.parse(JSON.stringify(t.data)),t};return this.use=function(i){if("object"!=typeof i)throw new Error("Wrong params in .use()");"boolean"==typeof i.exportToSheet&&(e.exportToSheet=i.exportToSheet),"boolean"==typeof i.zeroImpression&&(e.zeroImpression=i.zeroImpression),"number"==typeof i.lowImpressionShare&&(e.lowImpressionShare=i.lowImpressionShare)},this.awql=function(i){return i?(e.awqlOptions=i,Array.isArray(e.awqlOptions.select)&&(e.awqlOptions.select=e.awqlOptions.select.join(",")),Array.isArray(e.awqlOptions.during)&&(e.awqlOptions.during=e.awqlOptions.during.join(",")),{run:g}):{select:p}},this};