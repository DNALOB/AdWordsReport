function main() {

  var columns = ['CampaignName','Clicks','Impressions','AverageCpc','ConvertedClicks'];

  var adWordsReport = new AdWordsReport({
    exportToSheet: true
  });

  var report = adWordsReport.awql()
    .select(columns)
    .from('CAMPAIGN_PERFORMANCE_REPORT')
    .where('Clicks > 10')
    .and('Impressions > 20')
    .during('20160101,20160131')
    .run();

  Logger.log('Spreadsheet created, check it out: ' + report.sheetUrl);
}

/**
 * @license MIT
 * @author Victor Kaugesaar <kaugesaar@gmail.com>
 * AdWordsReport.js (http://github.com/getscript/AdWordsReport)
 * Built for AdWords API v201607
 * Licensed under the MIT license
 */
var AdWordsReport=function(e){"use strict";e=e||{},e.exportToSheet=e.exportToSheet||!1,e.zeroImpression=e.zeroImpression||!0,e.lowImpressionShare=e.lowImpressionShare||.01,e.awqlOptions={};var i=[],r=function(e){return a(e)},t=function(e){return"--"===e?[]:"object"==typeof JSON.parse(e)?JSON.parse(e):[e]},a=function(e){return String(e)},o=function(i){return i=String(i),i.indexOf("<")>-1?e.lowImpressionShare:i.indexOf("%")>-1?Number(i.replace(/[%]/g,""))/100:"--"===i?Number(0):Number(i.replace(/,/g,""))},n={AccountCurrencyCode:a,AccountDescriptiveName:a,AccountTimeZoneId:a,ActiveViewCpm:o,ActiveViewCtr:o,ActiveViewImpressions:o,ActiveViewMeasurability:o,ActiveViewMeasurableCost:o,ActiveViewMeasurableImpressions:o,ActiveViewViewability:o,AdFormat:a,AdGroupAdDisapprovalReasons:t,AdGroupAdTrademarkDisapproved:_boolean,AdGroupCount:o,AdGroupCreativesCount:o,AdGroupCriteriaCount:o,AdGroupCriterionStatus:a,AdGroupDesktopBidModifier:o,AdGroupId:o,AdGroupMobileBidModifier:o,AdGroupName:a,AdGroupsCount:o,AdGroupStatus:a,AdGroupTabletBidModifier:o,AdId:o,AdNetworkType1:a,AdNetworkType2:a,AdType:a,AdvertiserExperimentSegmentationBin:a,AdvertisingChannelSubType:a,AdvertisingChannelType:a,AggregatorId:o,AllConversionRate:o,AllConversions:o,AllConversionValue:o,Amount:o,AoiMostSpecificTargetId:o,ApprovalStatus:a,AssociatedCampaignId:o,AssociatedCampaignName:a,AssociatedCampaignStatus:a,AttributeValues:t,AverageCost:o,AverageCpc:o,AverageCpe:o,AverageCpm:o,AverageCpv:o,AverageFrequency:o,AveragePageviews:o,AveragePosition:o,AverageTimeOnSite:o,BaseAdGroupId:o,BaseCampaignId:o,BenchmarkAverageMaxCpc:o,BenchmarkCtr:o,BiddingStrategyId:o,BiddingStrategyName:a,BiddingStrategySource:a,BiddingStrategyType:a,BidModifier:o,BidType:a,BounceRate:o,Brand:a,BudgetCampaignAssociationStatus:a,BudgetId:o,BudgetName:a,BudgetReferenceCount:o,BudgetStatus:a,BusinessName:a,CallDuration:o,CallEndTime:o,CallerCountryCallingCode:a,CallerNationalDesignatedCode:a,CallOnlyPhoneNumber:a,CallStartTime:o,CallStatus:a,CallTrackingDisplayLocation:a,CallType:a,CampaignCount:o,CampaignDesktopBidModifier:o,CampaignId:o,CampaignLocationTargetId:o,CampaignMobileBidModifier:o,CampaignName:a,CampaignsCount:o,CampaignStatus:a,CampaignTabletBidModifier:o,CampaignTrialType:a,CanManageClients:_boolean,Category0:a,Category1:a,Category2:a,CategoryL1:a,CategoryL2:a,CategoryL3:a,CategoryL4:a,CategoryL5:a,CategoryPaths:a,Channel:a,ChannelExclusivity:a,CityCriteriaId:o,ClickAssistedConversions:o,ClickAssistedConversionsOverLastClickConversions:o,ClickAssistedConversionValue:o,Clicks:o,ClickSignificance:o,ClickType:a,CombinedAdsOrganicClicks:o,CombinedAdsOrganicClicksPerQuery:o,CombinedAdsOrganicQueries:o,ContentBidCriterionTypeGroup:a,ContentBudgetLostImpressionShare:o,ContentImpressionShare:o,ContentRankLostImpressionShare:o,ConversionCategoryName:a,ConversionRate:o,Conversions:o,ConversionTrackerId:o,ConversionTypeName:a,ConversionValue:o,Cost:o,CostPerAllConversion:o,CostPerConversion:o,CostSignificance:o,CountryCriteriaId:o,CpcBid:o,CpcBidSource:a,CpcSignificance:o,CpmBid:o,CpmBidSource:a,CpmSignificance:o,CpvBid:o,CpvBidSource:a,CreativeApprovalStatus:a,CreativeConversionRate:o,CreativeConversions:o,CreativeDestinationUrl:a,CreativeFinalAppUrls:t,CreativeFinalMobileUrls:t,CreativeFinalUrls:t,CreativeId:o,CreativeQualityScore:a,CreativeStatus:a,CreativeTrackingUrlTemplate:a,CreativeUrlCustomParameters:t,Criteria:a,CriteriaDestinationUrl:a,CriteriaId:o,CriteriaParameters:a,CriteriaStatus:a,CriteriaType:a,CriteriaTypeName:a,CriterionId:o,CriterionType:a,CrossDeviceConversions:o,Ctr:o,CtrSignificance:o,CustomAttribute0:a,CustomAttribute1:a,CustomAttribute2:a,CustomAttribute3:a,CustomAttribute4:a,CustomerDescriptiveName:a,Date:r,DayOfWeek:a,DeliveryMethod:a,Description:a,Description1:a,Description2:a,DestinationUrl:a,Device:a,DevicePreference:o,DisapprovalShortNames:t,DisplayName:a,DisplayUrl:a,DistanceBucket:a,Domain:a,EffectiveDestinationUrl:a,EffectiveFinalUrl:a,EffectiveTrackingUrlTemplate:a,EndDate:r,EndTime:r,EngagementRate:o,Engagements:o,EnhancedCpcEnabled:_boolean,EnhancedCpvEnabled:_boolean,EstimatedAddClicksAtFirstPositionCpc:o,EstimatedAddCostAtFirstPositionCpc:o,ExtensionPlaceholderCreativeId:o,ExtensionPlaceholderType:o,ExternalCustomerId:o,FeedId:o,FeedItemAttributes:t,FeedItemEndTime:o,FeedItemId:o,FeedItemStartTime:o,FeedItemStatus:a,FinalAppUrls:t,FinalMobileUrls:t,FinalUrl:a,FinalUrls:t,FirstPageCpc:o,FirstPositionCpc:o,GclId:a,GeoTargetingCriterionId:o,GeoTargetingRestriction:a,GmailForwards:o,GmailSaves:o,GmailSecondaryClicks:o,HasQualityScore:_boolean,Headline:a,HeadlinePart1:a,HeadlinePart2:a,HourOfDay:o,Id:o,ImageAdUrl:a,ImageCreativeImageHeight:o,ImageCreativeImageWidth:o,ImageCreativeName:a,ImpressionAssistedConversions:o,ImpressionAssistedConversionsOverLastClickConversions:o,ImpressionAssistedConversionValue:o,ImpressionReach:o,Impressions:o,ImpressionSignificance:o,InteractionRate:o,Interactions:o,InteractionTypes:a,InvalidClickRate:o,InvalidClicks:o,IsAutoOptimized:_boolean,IsAutoTaggingEnabled:_boolean,IsBidOnPath:_boolean,IsBudgetExplicitlyShared:_boolean,IsNegative:_boolean,IsPathExcluded:_boolean,IsRestrict:_boolean,IsSelfAction:_boolean,IsTargetingLocation:_boolean,IsTestAccount:_boolean,KeywordId:o,KeywordMatchType:a,KeywordTargetingId:o,KeywordTargetingMatchType:a,KeywordTargetingText:a,KeywordTextMatchingQuery:a,LabelId:o,LabelIds:t,LabelName:a,Labels:t,LanguageCriteriaId:o,Line1:a,LocationType:a,LongHeadline:a,LopMostSpecificTargetId:o,MemberCount:o,MerchantId:o,MetroCriteriaId:o,Month:a,MonthOfYear:a,MostSpecificCriteriaId:o,Name:a,NonRemovedAdGroupCount:o,NonRemovedAdGroupCriteriaCount:o,NonRemovedCampaignCount:o,NumOfflineImpressions:o,NumOfflineInteractions:o,OfferId:a,OfflineInteractionRate:o,OrganicAveragePosition:o,OrganicClicks:o,OrganicClicksPerQuery:o,OrganicImpressions:o,OrganicImpressionsPerQuery:o,OrganicQueries:o,Page:o,PageOnePromotedBidCeiling:o,PageOnePromotedBidChangesForRaisesOnly:_boolean,PageOnePromotedBidModifier:o,PageOnePromotedRaiseBidWhenBudgetConstrained:_boolean,PageOnePromotedRaiseBidWhenLowQualityScore:_boolean,PageOnePromotedStrategyGoal:a,Parameter:a,ParentCriterionId:o,PartitionType:a,Path1:a,Path2:a,PercentNewVisitors:o,Period:a,PlaceholderType:o,PositionSignificance:o,PostClickQualityScore:a,PrimaryCompanyName:a,ProductCondition:a,ProductGroup:a,ProductTypeL1:a,ProductTypeL2:a,ProductTypeL3:a,ProductTypeL4:a,ProductTypeL5:a,QualityScore:o,Quarter:a,Query:a,QueryMatchType:a,QueryMatchTypeWithVariant:a,ReferenceCount:o,RegionCriteriaId:o,RelativeCtr:o,Scheduling:t,SearchBudgetLostImpressionShare:o,SearchClickShare:o,SearchExactMatchImpressionShare:o,SearchImpressionShare:o,SearchPredictedCtr:a,SearchQuery:a,SearchRankLostImpressionShare:o,SerpType:a,ServingStatus:a,SharedSetId:o,SharedSetName:a,SharedSetType:a,ShortHeadline:a,Slot:a,StartDate:r,StartTime:r,Status:a,StoreId:a,SystemServingStatus:a,SystemStatus:a,TargetCpa:o,TargetCpaBidSource:a,TargetCpaMaxCpcBidCeiling:o,TargetCpaMaxCpcBidFloor:o,TargetingAdGroupId:o,TargetingCampaignId:o,TargetOutrankShare:o,TargetOutrankShareBidChangesForRaisesOnly:_boolean,TargetOutrankShareCompetitorDomain:a,TargetOutrankShareMaxCpcBidCeiling:o,TargetOutrankShareRaiseBidWhenLowQualityScore:_boolean,TargetRoas:o,TargetRoasBidCeiling:o,TargetRoasBidFloor:o,TargetSpendBidCeiling:o,TargetSpendSpendTarget:o,Title:a,TopOfPageCpc:o,TrackingUrlTemplate:a,Trademarks:t,Type:a,Url:a,UrlCustomParameters:t,UserListId:o,UserListName:a,UserListsCount:o,ValidationDetails:t,ValuePerAllConversion:o,ValuePerConversion:o,VideoChannelId:a,VideoDuration:o,VideoId:a,VideoQuartile100Rate:o,VideoQuartile25Rate:o,VideoQuartile50Rate:o,VideoQuartile75Rate:o,VideoTitle:a,VideoViewRate:o,VideoViews:o,ViewThroughConversions:o,ViewThroughConversionsSignificance:o,Week:a,Year:o},s=function(e,i){var r={};return i.forEach(function(i){if(void 0!==n[i]){var t=e[i];r[i]=n[i](t)}}),r},d=function(i){return Array.isArray(i)&&(i=i.join(",")),e.awqlOptions.select=i,{from:l}},l=function(i){return e.awqlOptions.from=i,{where:p,and:C,during:c}},p=function(i){return e.awqlOptions.where=i,{and:C,during:c}},C=function(i){return e.awqlOptions.and||(e.awqlOptions.and=[]),Array.isArray(i)?e.awqlOptions.and=[].contact.apply([],e.awqlOptions.and,i):e.awqlOptions.and.push(i),{and:C,during:c}},c=function(i){return Array.isArray(i)&&(i=i.join(",")),e.awqlOptions.during=i,{run:u}},u=function(){var i=e.awqlOptions;"object"==typeof e.awqlOptions?(i="SELECT "+e.awqlOptions.select+" FROM "+e.awqlOptions.from,e.awqlOptions.where&&(i+=" WHERE "+e.awqlOptions.where),e.awqlOptions.and&&(i+=" AND "+e.awqlOptions.and.join(" AND ")),e.awqlOptions.during&&(i+=" DURING "+e.awqlOptions.during)):"string"==typeof i&&(i=i.split(", ").join(","));var r={includeZeroImpressions:e.zeroImpression};e.awqlOptions={};var t=AdWordsApp.report(i,r);return v(t)},g=function(){return this.data.length>0},m=function(){return this.data.splice(this.data.length-1,1)[0]},S=function(){return i.length>0?{hasNext:g,next:m,data:JSON.parse(JSON.stringify(i))}:void Logger.log("Cant use .rows() since there are no rows.")},v=function(r){var t={};t.rows=S,t.data=[];var a=(new Date).toLocaleDateString();if(e.exportToSheet){var o=SpreadsheetApp.create("AdWordsReport - "+a);r.exportToSheet(o.getActiveSheet()),t.sheetUrl=o.getUrl(),t.sheetId=o.getId(),t.sheetName=o.getName()}for(var n=r.rows();n.hasNext();){var d=n.next(),l=Object.keys(d),p=s(d,l);t.data.push(p)}return i=JSON.parse(JSON.stringify(t.data)),t};return this.use=function(i){if("object"!=typeof i)throw new Error("Wrong params in .use()");"boolean"==typeof i.exportToSheet&&(e.exportToSheet=i.exportToSheet),"boolean"==typeof i.zeroImpression&&(e.zeroImpression=i.zeroImpression),"number"==typeof i.lowImpressionShare&&(e.lowImpressionShare=i.lowImpressionShare)},this.awql=function(i){return i?(e.awqlOptions=i,Array.isArray(e.awqlOptions.select)&&(e.awqlOptions.select=e.awqlOptions.select.join(",")),Array.isArray(e.awqlOptions.during)&&(e.awqlOptions.during=e.awqlOptions.during.join(",")),{run:u}):{select:d}},this};